<!-- Candidature Card -->
<div class="bg-white rounded-2xl border border-gray-200 hover:border-blue-300 hover:shadow-xl transition-all duration-300 overflow-visible group">

  <!-- Status top bar -->
  <div
    class="h-1.5 transition-all duration-300"
    [ngClass]="{
      'bg-yellow-400': candidature.status === 'En attente',
      'bg-emerald-500': candidature.status === 'Accepté',
      'bg-red-500': candidature.status === 'Refusé'
    }">
  </div>


  <!-- Card content -->
  <div class="p-6">

    <!-- Header -->
    <div class="flex justify-between items-start mb-4">

      <!-- Left info -->
      <div>

        <!-- Title -->
        <h3 class="text-xl font-bold text-gray-900 group-hover:text-blue-600 transition">
          {{ candidature.title }}
        </h3>

        <!-- Company -->
        <div class="flex items-center gap-2 text-gray-600 mt-1">
          <svg class="w-4 h-4" fill="none" stroke="currentColor">
            <path stroke-width="2" d="M3 21h18M5 21V7l8-4 8 4v14"/>
          </svg>

          <span class="font-medium">
            {{ candidature.company }}
          </span>

        </div>

        <!-- Location -->
        <div class="flex items-center gap-2 text-sm text-gray-500 mt-1">
          <svg class="w-4 h-4" fill="none" stroke="currentColor">
            <path stroke-width="2" d="M17.657 16.657L13.414 20.9"/>
          </svg>

          {{ candidature.location }}
        </div>

      </div>


      <!-- Status Badge -->
      <span
        class="px-3 py-1 text-xs font-semibold rounded-full border"
        [ngClass]="{
          'bg-yellow-50 text-yellow-700 border-yellow-200': candidature.status === 'En attente',
          'bg-emerald-50 text-emerald-700 border-emerald-200': candidature.status === 'Accepté',
          'bg-red-50 text-red-700 border-red-200': candidature.status === 'Refusé'
        }"
      >
        {{ candidature.status }}
      </span>

    </div>


    <!-- Date -->
    <div class="text-xs text-gray-500 mb-4">
      Candidature envoyée le {{ candidature.dateAdded }}
    </div>


    <!-- Notes display -->
    <div *ngIf="candidature.notes && !isEditingNotes"
         class="bg-gray-50 border rounded-lg p-3 text-sm text-gray-600 mb-4">

      {{ candidature.notes }}

    </div>


    <!-- Notes edit -->
    <textarea
      *ngIf="isEditingNotes"
      [(ngModel)]="editedNotes"
      class="w-full border rounded-lg p-2 mb-4 focus:ring-2 focus:ring-blue-500 outline-none"
      rows="3">
    </textarea>



    <!-- ACTIONS -->
    <div class="flex flex-wrap gap-2 items-center">


      <!-- STATUS DROPDOWN -->
      <div class="relative">

        <!-- Trigger -->
        <button
          (click)="toggleStatusDropdown()"
          class="px-4 py-2 text-sm border rounded-lg bg-gray-50 hover:bg-gray-100 transition flex items-center gap-2">

          Changer statut

          <svg class="w-4 h-4"
               fill="none"
               stroke="currentColor">

            <path stroke-width="2" d="M19 9l-7 7-7-7"/>

          </svg>

        </button>


        <!-- Dropdown -->
        <div
          *ngIf="showStatusDropdown"
          class="absolute top-full left-0 mt-2 w-48 bg-white border rounded-xl shadow-lg z-50 overflow-hidden">

          <!-- Option -->
          <button
            (click)="changeStatus('En attente')"
            class="w-full px-4 py-3 text-left hover:bg-yellow-50 flex items-center gap-2">

            <span class="w-2 h-2 bg-yellow-400 rounded-full"></span>

            En attente

          </button>


          <button
            (click)="changeStatus('Accepté')"
            class="w-full px-4 py-3 text-left hover:bg-emerald-50 flex items-center gap-2">

            <span class="w-2 h-2 bg-emerald-500 rounded-full"></span>

            Accepté

          </button>


          <button
            (click)="changeStatus('Refusé')"
            class="w-full px-4 py-3 text-left hover:bg-red-50 flex items-center gap-2">

            <span class="w-2 h-2 bg-red-500 rounded-full"></span>

            Refusé

          </button>

        </div>

      </div>



      <!-- Notes buttons -->
      <button
        *ngIf="!isEditingNotes"
        (click)="startEditingNotes()"
        class="px-4 py-2 text-sm border rounded-lg bg-gray-50 hover:bg-gray-100">

        {{ candidature.notes ? 'Modifier notes' : 'Ajouter notes' }}

      </button>


      <button
        *ngIf="isEditingNotes"
        (click)="saveNotes()"
        class="px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700">

        Enregistrer

      </button>


      <button
        *ngIf="isEditingNotes"
        (click)="cancelEditingNotes()"
        class="px-4 py-2 text-sm border rounded-lg hover:bg-gray-100">

        Annuler

      </button>



      <!-- View -->
      <a
        [href]="candidature.url"
        target="_blank"
        class="px-4 py-2 text-sm bg-blue-50 text-blue-700 border border-blue-200 rounded-lg hover:bg-blue-100">

        Voir l'offre

      </a>


      <!-- Delete -->
      <button
        (click)="deleteCandidature()"
        class="ml-auto px-4 py-2 text-sm bg-red-50 text-red-700 border border-red-200 rounded-lg hover:bg-red-100">

        Supprimer

      </button>


    </div>


  </div>

</div>
